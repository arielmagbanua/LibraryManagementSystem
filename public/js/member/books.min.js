$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}});var a=new Date;a.setDate(a.getDate()-1),$("#borrow_start_date").datepicker({format:"yyyy-mm-dd",clearBtn:!0,autoclose:!0,todayHighlight:!0,startDate:a});var o=$("#baseURL").html(),t=o+"/serverSide/borrowBooksList";$("#books_datatable").DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:t,type:"get",error:function(){}},columns:[{data:"title"},{data:"author"},{data:"isbn"},{data:"quantity"},{data:"overdue_fine"},{data:"shelf_location"},{data:"actions",orderable:!1}]}),$("#borrow_book_modal").on("show.bs.modal",function(a){if("bs.modal"===a.namespace){$(".modal-title").html("Borrow"),$("#borrow_start_date").val("");var o=$(a.relatedTarget),t=o.data("action");if("borrow_book"==t){var e=o.data("id");$("#book_id_to_borrow").val(e);var r=$("#borrow_button"),s=r.find("span.borrow-label");s.html("Yes"),s.removeClass("fa fa-spin fa-spinner"),r.removeAttr("disabled"),r.show(),$("#borrow_cancel_button").html("Cancel"),$("#borrow_modal_message").html("Borrow a copy of this book?")}}}),$("#borrow_button").click(function(){var a=$("#book_id_to_borrow").val(),t=$("#borrow_start_date").val();if(""==t||void 0==t)return void $("#borrow_modal_message").html("Please provide the borrow start date!");var e=$(this),r=$("#borrow_cancel_button"),s=e.find("span.borrow-label");s.html(""),s.addClass("fa fa-spin fa-spinner"),e.prop("disabled",!0),r.prop("disabled",!0);var l=o+"/member/book/"+a+"/borrow/"+t;$.ajax({type:"post",url:l,success:function(a){var o=$("#books_datatable").DataTable();o.ajax.reload(function(){"fail"==a.status?($(".modal-title").html("Ooppps!"),$("#borrow_modal_message").html(a.message),r.html("Ok, Understand")):($(".modal-title").html("Borrow"),$("#borrow_modal_message").html(a.message),r.html("Close")),e.hide(),r.removeAttr("disabled")},!1)}})})});