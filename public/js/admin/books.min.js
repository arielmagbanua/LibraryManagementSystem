$(document).ready(function(){$(".search-select").select2({theme:"bootstrap",dropdownParent:$("#book_modal_form")});var a=$("#baseURL").html(),e=a+"/serverSide/booksList";$("#books_datatable").DataTable({processing:!0,serverSide:!0,dom:'<"row" <"col-md-6" <"row" <"col-md-4" l><"col-md-8 add_book" >>><"col-md-6" f>>rt<"row" <"col-md-6" i><"col-md-6" p>>',order:[[0,"desc"]],ajax:{url:e,type:"get",error:function(){}},columns:[{data:"title"},{data:"author"},{data:"isbn"},{data:"quantity"},{data:"overdue_fine"},{data:"shelf_location"},{data:"actions",orderable:!1}]}),$("div.add_book").html('<button class="btn btn-success" data-action="add_book" data-toggle="modal" data-target="#book_modal_form">Add Book</button><a style="margin-left: 8px" class="btn btn-primary" href="'+a+'/serverSide/downloadBooksList">Download List</a>'),$("#book_modal_form").on("show.bs.modal",function(e){if("bs.modal"===e.namespace){var t=$(e.relatedTarget),o=t.data("action"),l=$("#book_form");if("edit_book"==o){var d=t.data("id");$(".modal-title").html("Edit Book"),$(".save-label").html("Save Changes"),l.attr("action",a+"/book/"+d),l.attr("method","PATCH"),l.data("success","Book updated successfully!");var s="#book-"+d+"-",n=$(s+"title").html(),r=$(s+"author").data("author"),i=$(s+"isbn").html(),m=$(s+"quantity").html(),c=$(s+"overdue_fine").html(),b=$(s+"shelf_location").html(),f=$("#book_modal_form");f.find("#title").val(n),f.find("#author_id").val(r).trigger("change"),f.find("#isbn").val(i),f.find("#quantity").val(m),f.find("#overdue_fine").val(c),f.find("#shelf_location").val(b)}else $("#book_modal_form :input").val(""),$(".modal-title").html("Add Book"),$(".save-label").html("Save"),l.attr("action",a+"/book"),l.attr("method","POST"),l.data("success","Book added successfully!")}}),$("#delete_modal").on("show.bs.modal",function(a){var e=$(a.relatedTarget),t=e.data("action");if("delete_book"==t){$(".modal-title").html("Delete Book");var o=e.data("id");$("#id_to_delete").val(o);var l=$("#delete_button"),d=l.find("span.delete-label");d.html("Yes Delete"),d.removeClass("fa fa-spin fa-spinner"),l.removeAttr("disabled"),l.show(),$("#delete_cancel_button").html("Cancel"),$("#delete_modal_message").html("Are you sure you want to delete this book?")}}),$("#delete_button").click(function(){var e=$("#id_to_delete").val(),t=$(this),o=$("#delete_cancel_button"),l=t.find("span.delete-label");l.html(""),l.addClass("fa fa-spin fa-spinner"),t.prop("disabled",!0),o.prop("disabled",!0);var d=a+"/book/"+e;$.ajax({type:"DELETE",url:d,success:function(){var a=$("#books_datatable").DataTable();a.ajax.reload(function(){$("#delete_modal_message").html("The book was successfully deleted!"),t.hide(),o.html("Close"),o.removeAttr("disabled")},!1)}})})});