{"version":3,"sources":["members.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"members.min.js","sourcesContent":["$(document).ready(function()\r\n{\r\n    $('#birth_date').datepicker({\r\n        format: \"yyyy-mm-dd\",\r\n        clearBtn: true,\r\n        autoclose: true,\r\n        defaultViewDate: { year: 1998, month: 00, day: 01 }\r\n    });\r\n\r\n    var baseURL = $('#baseURL').html();\r\n\r\n    var membersListURL = baseURL+'/serverSide/membersList';\r\n\r\n    $('#members_datatable').DataTable({\r\n        'processing': true,\r\n        'serverSide': true,\r\n        'dom':'<\"row\" <\"col-md-6\" <\"row\" <\"col-md-4\" l><\"col-md-8 add_member\" >>><\"col-md-6\" f>>rt<\"row\" <\"col-md-6\" i><\"col-md-6\" p>>',\r\n        'order': [[ 0, \"asc\" ]],\r\n        'ajax': {\r\n            url: membersListURL,\r\n            type: 'get',\r\n            error: function() {}\r\n        },\r\n        'columns':[\r\n            {'data':'id'},\r\n            {'data':'first_name'},\r\n            {'data':'middle_name'},\r\n            {'data':'last_name'},\r\n            {'data':'address'},\r\n            {'data':'email'},\r\n            {'data':'birth_date'},\r\n            {'data':'actions','orderable': false}\r\n        ]\r\n    });\r\n\r\n    $(\"div.add_member\").html('<button class=\"btn btn-success\" data-action=\"add_member\" data-toggle=\"modal\" data-target=\"#member_modal_form\">Add Member</button>');\r\n\r\n    $('#member_modal_form').on('show.bs.modal', function (e) {\r\n\r\n        if(e.namespace === 'bs.modal')\r\n        {\r\n\r\n            var invoker = $(e.relatedTarget);\r\n            var invokerAction = invoker.data('action');\r\n\r\n            var memberForm = $('#member_form');\r\n\r\n            if(invokerAction=='edit_member')\r\n            {\r\n                var memberID = invoker.data('id');\r\n                console.log(memberID);\r\n\r\n                //change the title of the modal\r\n                $('.modal-title').html('Edit Member');\r\n                //change the text of submit button\r\n                $('.save-label').html('Save Changes');\r\n\r\n                memberForm.attr('action',baseURL+'/user/'+memberID);\r\n                memberForm.attr('method','PATCH');\r\n                memberForm.data('success','Member updated successfully!');\r\n\r\n                //hide all password fields\r\n                $('.password-field').hide();\r\n                $('#email').prop('readonly',true);\r\n\r\n                //row base ID\r\n                var rowBaseID = '#member-'+memberID+'-';\r\n\r\n                //get all the data from row\r\n                var firstName = $(rowBaseID+'first_name').html();\r\n                var middleName = $(rowBaseID+'middle_name').html();\r\n                var lastName = $(rowBaseID+'last_name').html();\r\n                var address = $(rowBaseID+'address').html();\r\n                var email = $(rowBaseID+'email').html();\r\n                var birthDate = $(rowBaseID+'birth_date').html();\r\n\r\n                //load the data in the form\r\n                var modal = $('#member_modal_form');\r\n                modal.find('#first_name').val(firstName);\r\n                modal.find('#middle_name').val(middleName);\r\n                modal.find('#last_name').val(lastName);\r\n                modal.find('#address').val(address);\r\n                modal.find('#email').val(email);\r\n                modal.find('#birth_date').val(birthDate);\r\n            }\r\n            else\r\n            {\r\n                $('.password-field').show();\r\n                $('#member_modal_form :input').val('');\r\n                $('#email').removeAttr('readonly');\r\n\r\n                //change the title of the modal\r\n                $('.modal-title').html('Add Member');\r\n                //change the text of submit button\r\n                $('.save-label').html('Save');\r\n\r\n                memberForm.attr('action', baseURL+'/user');\r\n                memberForm.attr('method', 'POST');\r\n                memberForm.data('success','Member added successfully!');\r\n            }\r\n\r\n        }\r\n\r\n    });\r\n\r\n    $('#delete_modal').on('show.bs.modal', function (e) {\r\n\r\n        var invoker = $(e.relatedTarget);\r\n        var invokerAction = invoker.data('action');\r\n\r\n        if(invokerAction=='delete_member')\r\n        {\r\n            $('.modal-title').html('Delete Member');\r\n\r\n            var memberID = invoker.data('id');\r\n            console.log(memberID);\r\n            //load the id to the hidden field of the modal for deletion\r\n            $('#id_to_delete').val(memberID);\r\n\r\n            //set the yes button to defaults\r\n            var deleteButton = $('#delete_button');\r\n            var deleteLabel = deleteButton.find('span.delete-label');\r\n            deleteLabel.html('Yes Delete');\r\n            deleteLabel.removeClass('fa fa-spin fa-spinner');\r\n            deleteButton.removeAttr('disabled');\r\n            deleteButton.show();\r\n            $('#delete_cancel_button').html('Cancel');\r\n\r\n            //set the body message to default\r\n            $('#delete_modal_message').html('Are you sure you want to delete this member?');\r\n        }\r\n\r\n    });\r\n\r\n    $('#delete_button').click(function()\r\n    {\r\n        //get the member id\r\n        var memberID = $('#id_to_delete').val();\r\n        console.log(memberID);\r\n\r\n        var deleteButton = $(this);\r\n        var deleteCancelButton = $('#delete_cancel_button');\r\n\r\n        //modify the delete label to show spinner load\r\n        var deleteLabel = deleteButton.find('span.delete-label');\r\n        deleteLabel.html('');\r\n        deleteLabel.addClass('fa fa-spin fa-spinner');\r\n        deleteButton.prop('disabled',true);\r\n        deleteCancelButton.prop('disabled',true);\r\n\r\n        var deleteURL = baseURL + '/user/'+memberID;\r\n        console.log(deleteURL);\r\n\r\n        $.ajax({\r\n            type: 'DELETE',\r\n            url: deleteURL,\r\n            success: function()\r\n            {\r\n                //remove the record in datatable\r\n                var table = $('#members_datatable').DataTable();\r\n                //var row = $('#member-'+memberID+'-first_name').parents('tr');\r\n                //table.row(row).remove().draw();\r\n\r\n                table.ajax.reload(function(){\r\n\r\n                    //Change the message of modal and hide the delete button\r\n                    $('#delete_modal_message').html('The member was successfully deleted!');\r\n                    deleteButton.hide();\r\n                    deleteCancelButton.html('Close');\r\n                    deleteCancelButton.removeAttr('disabled');\r\n\r\n                },false);\r\n            }\r\n        });\r\n\r\n    });\r\n\r\n});\r\n"]}