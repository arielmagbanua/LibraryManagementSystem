$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}});var e=$("#baseURL").html(),a=e+"/serverSide/memberBorrowedBooksList";$("#pending_borrowed_books_datatable").DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:a,type:"get",error:function(){}},columns:[{data:"title"},{data:"author_name"},{data:"isbn"},{data:"borrow_start_date"},{data:"fine"},{data:"borrower"},{data:"borrower_email"},{data:"actions",orderable:!1}]}),$("#request_modal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("action"),o=a.data("id"),r=a.data("member"),s=$("#yes_button"),n=s.find("span.yes-label");"return_book"==t?($(".modal-title").html("Return Book"),s.data("action","return_book"),$("#request_id_to_return").val(o),s.removeClass("btn-default"),s.removeClass("btn-danger"),s.addClass("btn-success"),s.removeAttr("disabled"),s.show(),n.html("Yes"),n.removeClass("fa fa-spin fa-spinner"),$("#cancel_button").html("Cancel"),$("#request_modal_message").html("Are you sure that "+r+" already returned this book?")):"return_book_pending"==t&&($(".modal-title").html("Return Book as Pending Request."),s.data("action","return_book_pending"),$("#request_id_to_return").val(o),s.removeClass("btn-default"),s.removeClass("btn-danger"),s.addClass("btn-primary"),s.removeAttr("disabled"),s.show(),n.html("Yes"),n.removeClass("fa fa-spin fa-spinner"),$("#cancel_button").html("Cancel"),$("#request_modal_message").html("Are you sure you want to return this borrowed book as pending request?"))}),$("#yes_button").click(function(){var a=$(this),t=a.data("action"),o=a.find("span.yes-label");o.html(""),o.addClass("fa fa-spin fa-spinner");var r=$("#cancel_button"),s=$("#request_id_to_return").val();a.prop("disabled",!0),r.prop("disabled",!0);var n="";"return_book"===t?n=e+"/admin/book/"+s+"/book_returned":"return_book_pending"===t&&(n=e+"/admin/book/"+s+"/return_book_pending"),$.ajax({type:"post",url:n,success:function(e){var t=$("#pending_borrowed_books_datatable").DataTable();t.ajax.reload(function(){"fail"==e.status?($(".modal-title").html("Ooppps!"),$("#request_modal_message").html(e.message),r.html("Ok, I Understand")):($(".modal-title").html("Success"),$("#request_modal_message").html(e.message),r.html("Close")),a.hide(),r.removeAttr("disabled")},!1)}})})});