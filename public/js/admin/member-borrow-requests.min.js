$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}});var e=$("#baseURL").html(),a=e+"/serverSide/pendingBorrowRequestForAdmin";$("#pending_borrowed_books_datatable").DataTable({processing:!0,serverSide:!0,order:[[0,"desc"]],ajax:{url:a,type:"get",error:function(){}},columns:[{data:"title"},{data:"isbn"},{data:"overdue_fine"},{data:"user_name"},{data:"email"},{data:"actions",orderable:!1}]}),$("#request_modal").on("show.bs.modal",function(e){var a=$(e.relatedTarget),t=a.data("action"),o=a.data("id"),r=$("#yes_button"),s=r.find("span.yes-label");"approve_borrow_request"==t?($(".modal-title").html("Approve Borrow Request"),r.data("action","approve_borrow_request"),$("#request_id_to_cancel_approve").val(o),r.removeClass("btn-default"),r.removeClass("btn-danger"),r.addClass("btn-success"),r.removeAttr("disabled"),r.show(),s.html("Yes Approve!"),s.removeClass("fa fa-spin fa-spinner"),$("#cancel_button").html("No"),$("#request_modal_message").html("Are you sure you want to approve this book borrow request?")):"reject_borrow_request"==t&&($(".modal-title").html("Reject Borrow Request"),r.data("action","reject_borrow_request"),$("#request_id_to_cancel_approve").val(o),r.removeClass("btn-default"),r.removeClass("btn-success"),r.addClass("btn-danger"),r.removeAttr("disabled"),r.show(),s.html("Yes Reject!"),s.removeClass("fa fa-spin fa-spinner"),$("#cancel_button").html("No"),$("#request_modal_message").html("Are you sure you want to reject this book borrow request?"))}),$("#yes_button").click(function(){var a=$(this),t=a.data("action"),o=a.find("span.yes-label");o.html(""),o.addClass("fa fa-spin fa-spinner");var r=$("#cancel_button"),s=$("#request_id_to_cancel_approve").val();a.prop("disabled",!0),r.prop("disabled",!0);var l="";"approve_borrow_request"===t?l=e+"/admin/book/"+s+"/approve_borrow_request":"reject_borrow_request"===t&&(l=e+"/admin/book/"+s+"/reject_borrow_request"),$.ajax({type:"post",url:l,success:function(e){var t=$("#pending_borrowed_books_datatable").DataTable();t.ajax.reload(function(){"fail"==e.status?($(".modal-title").html("Ooppps!"),$("#request_modal_message").html(e.message),r.html("Ok, Understand")):($(".modal-title").html("Cancel Borrow Request"),$("#request_modal_message").html(e.message),r.html("Close")),a.hide(),r.removeAttr("disabled")},!1)}})})});