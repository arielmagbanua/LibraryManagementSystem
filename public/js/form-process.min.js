$(document).ready(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}}),$(".modal_error_wrapper").hide()}),$(document).on("submit",".modal_form",function(a){a.preventDefault();var e=$(this),t=e.serialize(),r=e.attr("action"),d=e.attr("method"),s=e.find("span.save-label");s.html(""),s.addClass("fa fa-spin fa-spinner"),e.find(".modal-form-submit-button").attr("disabled","true"),e.find(".modal-cancel-button").attr("disabled","true"),$.ajax({type:d,data:t,url:r,error:function(a){var t=a.responseJSON;e.data("process");e.find(".this_errors").html(""),e.find(".modal_error_wrapper").show(),e.find(".this_errors").show();var r="<ul>";$.each(t,function(a,e){""!=e&&(r+='<li> <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> '+e[0]+"</li>"),$('label[for="'+a+'"]').addClass("error_label error"),$("#"+a).addClass("error_field error")}),r+="</ul>",e.find(".this_errors").append(r),e.find(".modal-form-submit-button").removeAttr("disabled"),e.find(".modal-cancel-button").removeAttr("disabled"),s.html("Save"),s.removeClass("fa fa-spin fa-spinner")},success:function(a){e.find(".error").each(function(){$(this).removeClass("error"),$(this).removeClass("error_field"),$(this).removeClass("error_label")}),$(".modal_error_wrapper").hide();var t=$(e.data("datatable")).DataTable(),r=$("#success_modal"),d=$("#success_modal_message");switch(a.process){case"update_user":var o=a.data,l=a.id,m="#member-"+l+"-";$(m+"first_name").html(o.first_name),$(m+"middle_name").html(o.middle_name),$(m+"last_name").html(o.last_name),$(m+"address").html(o.address),$(m+"email").html(o.email),$(m+"birth_date").html(o.birth_date),e.find(".modal-form-submit-button").removeAttr("disabled"),e.find(".modal-cancel-button").removeAttr("disabled"),s.removeClass("fa fa-spin fa-spinner"),s.html("Save Changes"),$(e.data("parentmodal")).modal("hide"),d.html(e.data("success")),r.modal("show");break;case"update_book":var o=a.data,l=a.id,m="#book-"+l+"-";$(m+"title").html(o.title);var n=$("#author_id option:selected").text(),i=$(m+"author");i.html(n),i.data("author",a.author_id),$(m+"isbn").html(o.isbn),$(m+"quantity").html(o.quantity),$(m+"overdue_fine").html(o.overdue_fine),$(m+"shelf_location").html(o.shelf_location),e.find(".modal-form-submit-button").removeAttr("disabled"),e.find(".modal-cancel-button").removeAttr("disabled"),s.removeClass("fa fa-spin fa-spinner"),s.html("Save Changes"),$(e.data("parentmodal")).modal("hide"),d.html(e.data("success")),r.modal("show");break;case"update_author":var o=a.data,l=a.id,m="#author-"+l+"-";$(m+"first_name").html(o.first_name),$(m+"middle_name").html(o.middle_name),$(m+"last_name").html(o.last_name),$(m+"description").html(o.description),$(m+"birth_date").html(o.birth_date),e.find(".modal-form-submit-button").removeAttr("disabled"),e.find(".modal-cancel-button").removeAttr("disabled"),s.removeClass("fa fa-spin fa-spinner"),s.html("Save Changes"),$(e.data("parentmodal")).modal("hide"),d.html(e.data("success")),r.modal("show");break;default:t.ajax.reload(function(){e.find(".modal-form-submit-button").removeAttr("disabled"),e.find(".modal-cancel-button").removeAttr("disabled"),s.removeClass("fa fa-spin fa-spinner"),s.html("Save"),$(e.data("parentmodal")).modal("hide"),d.html(e.data("success")),r.modal("show")},!1)}}})});